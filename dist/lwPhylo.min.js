function describeArc(r,a,n,o,t){var i=polarToCartesian(r,a,n,o),e=polarToCartesian(r,a,n,t);return["M",i.x,i.y,"A",n,n,0,0,0,e.x,e.y].join(" ")}function polarToCartesian(r,a,n,o){return{x:r+n*Math.cos(o),y:a+n*Math.sin(o)}}function radialLayout(t){var a={};return a.radii=get_radii(t),a.data=radial_data(t),a.arcs=get_arcs(a.data),a}function get_arcs(t){var a=[],n=t.map(t=>null===t.parentId?t.thisId:null).filter(t=>null!=t)[0];function r(a){for(var n=0;n<t.length;n++)if(t[n].parentId===a)var r=t[n].angle;return r}function e(a){for(var n=0;n<t.length;n++)if(t[n].thisId===a)var r=t[n].r;return r}for(var i=0;i<t.length;i++)t[i].thisId!==n&&a.push({start:reflectAngle(Math.min(t[i].angle,r(t[i].parentId)),"Y"),end:reflectAngle(Math.max(t[i].angle,r(t[i].parentId)),"Y"),radius:e(t[i].parentId),thisId:t[i].thisId,parentId:t[i].parentId});for(i=0;i<a.length;i++)Math.sign(a[i].start)!==Math.sign(a[i].end)&&(a[i].end=Math.abs(a[i].end),a[i].start=-Math.abs(a[i].start));return a.filter(t=>t.start!==t.end&0!==t.radius)}function reflectAngle(t,a){const n=Math.cos(t),r=Math.sin(t);return(e=Math.atan2(..."X"===a?[r,-n]:[-r,n])).toString().includes("3.1415")&&(e=Math.abs(e)),e;var e}function get_radii(t){var a=radial_data(t);function n(t){for(var n=0;n<a.length;n++)if(a[n].thisId===t.parentId)var r=a[n].r;return r}for(var r=[],e=a.map(t=>null===t.parentId?t.thisId:null).filter(t=>null!=t)[0],i=0;i<a.length;i++)a[i].thisId!==e&&r.push({thisId:a[i].thisId,thisLabel:a[i].thisLabel,x0:a[i].x,x1:n(a[i])*Math.cos(a[i].angle),y0:a[i].y,y1:n(a[i])*Math.sin(a[i].angle),isTip:a[i].isTip});return r}function radial_data(t){for(var a=fortify(t),n=numTips(t),r=1,e=0;e<a.length;e++)1==a[e].isTip&&(a[e].angle=r/n*2*Math.PI,r+=1);function i(t,n){for(var r=0;r<a.length;r++){if(a[r].thisId===t)var e=a[r].angle;if(a[r].thisId===n)var i=a[r].angle}return mean([e,i])}for(e=0;e<a.length;e++)!1===a[e].isTip&&(a[e].angle=i(a[e].children[0],a[e].children[1]));var h=a.map(t=>null===t.parentId?t.thisId:null).filter(t=>null!=t)[0];function l(t){for(var n=0;n<a.length;n++)if(a[n].thisId===t)var r=a[n].r;return r}a.sort((t,a)=>a.thisId-t.thisId);for(e=0;e<a.length;e++)if(a[e].parentId===h)!0===a[e].isTip?(a[e].r=a[e].branchLength,a[e].x=a[e].branchLength,a[e].y=0):(a[e].r=a[e].branchLength,a[e].x=a[e].branchLength*Math.cos(a[e].angle),a[e].y=a[e].branchLength*Math.sin(a[e].angle));else{var s=l(a[e].parentId);a[e].r=s+a[e].branchLength,a[e].x=(s+a[e].branchLength)*Math.cos(a[e].angle),a[e].y=(s+a[e].branchLength)*Math.sin(a[e].angle)}return a[0].r=0,a[0].x=0,a[0].y=0,a}function readTree(e){var n=(e=e.replace(/ \t/g,"")).split(/(;|\(|\)|,)/),l={parent:null,children:[]},r=l,t=0;for(const e of n)if(""!=e&&";"!=e)if("("==e){var a={parent:r,children:[]};r.children.push(a),r=a}else if(","==e){a={parent:r=r.parent,children:[]};r.children.push(a),r=a}else if(")"==e){if(null===(r=r.parent))break}else{var h=e.split(":");1==h.length?e.startsWith(":")?(r.label="",r.branchLength=parseFloat(h[0])):(r.label=h[0],r.branchLength=null):2==h.length?(r.label=h[0],r.branchLength=parseFloat(h[1])):console.warn(e,"I don't know what to do with two colons!"),r.id=t++}return r.id=t,l}function rectangleLayout(t){var r={};return r.horizontal_lines=get_horizontal(t),r.vertical_lines=get_vertical(t),r}function get_vertical(t){var r=get_horizontal(t);function n(t){for(var n=0;n<r.length;n++)if(r[n].parentId===t.parentId)var i=Math.abs(r[n].y0-t.y0);return i}for(var i=[],e=r.map(t=>null===t.parentId?t.thisId:null).filter(t=>null!=t)[0],l=0;l<r.length;l++)r[l].thisId!==e&&i.push({thisId:r[l].thisId,x0:r[l].x0,x1:r[l].x0,y0:r[l].y0,y1:r[l].y0+n(r[l]),heights:n(r[l])});return i}function get_horizontal(t){var r=fortify(t);r.map(t=>t.isTip?t.thisLabel:null).filter(t=>null!=t);r.map(t=>t.y=null);for(var n=1,i=0;i<r.length;i++)!0===r[i].isTip&&(r[i].y0=n,r[i].y1=n,n+=1);function e(t,n){for(var i=0;i<r.length;i++){if(r[i].thisId===t)var e=r[i].y0;if(r[i].thisId===n)var l=r[i].y0}return mean([e,l])}for(i=0;i<r.length;i++)!1===r[i].isTip&&(r[i].y0=e(r[i].children[0],r[i].children[1]),r[i].y1=e(r[i].children[0],r[i].children[1]));var l=r.map(t=>null===t.parentId?t.thisId:null).filter(t=>null!=t)[0];function a(t){for(var n=0;n<r.length;n++)if(r[n].thisId===t)var i=r[n].x1;return i}r.sort((t,r)=>r.thisId-t.thisId);for(i=0;i<r.length;i++)if(r[i].parentId===l)r[i].x0=0,r[i].x1=r[i].branchLength;else{var h=a(r[i].parentId);r[i].x0=h,r[i].x1=h+r[i].branchLength}return r.sort((t,r)=>t.thisId-r.thisId),r.map(({y:t,x:r,angle:n,...i})=>i)}function unrooted(t){var n={},e=fortify(equalAngleLayout(t));return n.tree_df=e,n.edges=edges(e),n}function equalAngleLayout(t){null===t.parent&&(t.start=0,t.end=2,t.angle=0,t.ntips=numTips(t),t.x=0,t.y=0);for(var n,e,a=t.start,r=0;r<t.children.length;r++)(n=t.children[r]).ntips=numTips(n),e=(t.end-t.start)*n.ntips/t.ntips,n.start=a,n.end=n.start+e,n.angle=n.start+(n.end-n.start)/2,a=n.end,n.x=t.x+n.branchLength*Math.sin(n.angle*Math.PI),n.y=t.y+n.branchLength*Math.cos(n.angle*Math.PI),equalAngleLayout(n);return t}function preorder(n,e=[]){e.push(n);for(var r=0;r<n.children.length;r++)e=preorder(n.children[r],e);return e}function levelorder(n){for(var e,r=[n],t=[];r.length>0;){e=r.pop(),t.push(e);for(const n of e.children)r.push(n)}return t}function numTips(n){var e=0;for(const r of levelorder(n))0==r.children.length&&e++;return e}function fortify(n,e=!0){var r=[];for(const e of preorder(n))null===e.parent?r.push({parentId:null,parentLabel:null,thisId:e.id,thisLabel:e.label,children:e.children.map(n=>n.id),branchLength:0,isTip:!1,x:e.x,y:e.y,angle:e.angle}):r.push({parentId:e.parent.id,parentLabel:e.parent.label,thisId:e.id,thisLabel:e.label,children:e.children.map(n=>n.id),branchLength:e.branchLength,isTip:0==e.children.length,x:e.x,y:e.y,angle:e.angle});return e&&(r=r.sort((function(n,e){return n.thisId-e.thisId}))),r}function edges(n,e=!1){var r,t=[];n.sort((function(n,e){return n.thisId-e.thisId}));for(const l of n){l.x,l.y;if(null!==l.parentId&&null!=(r=n[l.parentId]))if(e){var i={x1:l.x,y1:l.y,id1:l.thisId,x2:r.x,y2:l.y,id2:void 0};t.push(i);i={x1:r.x,y1:l.y,id1:void 0,x2:r.x,y2:r.y,id2:l.parentId};t.push(i)}else{i={x1:l.x,y1:l.y,id1:l.thisId,x2:r.x,y2:r.y,id2:l.parentId};t.push(i)}}return t}function mean(n,e){let r=0,t=0;if(void 0===e)for(let e of n)null!=e&&(e=+e)>=e&&(++r,t+=e);else{let i=-1;for(let l of n)null!=(l=e(l,++i,n))&&(l=+l)>=l&&(++r,t+=l)}if(r)return t/r}